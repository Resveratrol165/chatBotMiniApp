{"version":3,"file":"chatView.js","sources":["pages/chatView.vue","../../../Tools/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTovV29ya3NwYWNlL21pbmlhcHAvY2hhdEJvdE1pbmlBcHAvcGFnZXMvY2hhdFZpZXcudnVl"],"sourcesContent":["<template>\r\n  <view class=\"chat-container\">\r\n    <message-list\r\n      :chat-data=\"chatData\"\r\n      :loading=\"loading\"\r\n      @load-more=\"loadMoreMessages\"\r\n    />\r\n    <input-field\r\n      @send=\"handleSendMessage\"\r\n      @image-selected=\"handleImageSelected\"\r\n    />\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport MessageList from '@/components/MessageList.vue'\r\nimport InputField from '@/components/InputField.vue'\r\n\r\nconst loading = ref(false)\r\nconst page = ref(1)\r\nconst hasMore = ref(true)\r\n\r\nconst chatData = ref({\r\n  userName: '',\r\n  botName: '',\r\n  userAvatar: '',\r\n  botAvatar: '',\r\n  chat: []\r\n})\r\n\r\n// 处理发送消息\r\nconst handleSendMessage = (message) => {\r\n  chatData.value.chat.push({\r\n    char: \"USER\",\r\n    content: {\r\n      type: \"Text\",\r\n      message: message\r\n    }\r\n  })\r\n}\r\n\r\n// 处理图片选择\r\nconst handleImageSelected = (imagePath) => {\r\n  chatData.value.chat.push({\r\n    char: \"USER\",\r\n    content: {\r\n      type: \"Image\",\r\n      message: imagePath\r\n    }\r\n  })\r\n}\r\n\r\n// 初始化消息列表\r\nconst initMessages = async () => {\r\n  try {\r\n    // 模拟从服务器获取数据\r\n    const response = {\r\n      userName: \"用户\",\r\n      botName: \"AI助手\",\r\n      userAvatar: \"/static/user-avatar.png\",\r\n      botAvatar: \"/static/bot-avatar.png\",\r\n      chat: [\r\n        {\r\n          char: \"USER\", \r\n          content: {\r\n            type: \"Text\",\r\n            message: \"你好\"\r\n          }\r\n        },\r\n        {\r\n          char: \"BOT\", \r\n          content: {\r\n            type: \"Text\",\r\n            message: \"你好！很高兴为你服务。我可以帮你处理文字、图片和音频消息。\"\r\n          }\r\n        },\r\n        {\r\n          char: \"USER\", \r\n          content: {\r\n            type: \"Image\",\r\n            message: \"https://img.picui.cn/free/2025/02/04/67a19ace30f9b.jpg\"\r\n          }\r\n        },\r\n        {\r\n          char: \"BOT\", \r\n          content: {\r\n            type: \"Text\",\r\n            message: \"我看到你发送了一张图片。图片处理功能正常工作中。\"\r\n          }\r\n        },\r\n        {\r\n          char: \"USER\", \r\n          content: {\r\n            type: \"Audio\",\r\n            message: \"audio_file_url\",\r\n            length: 15\r\n          }\r\n        },\r\n        {\r\n          char: \"BOT\", \r\n          content: {\r\n            type: \"Text\",\r\n            message: \"收到你的语音消息，时长15秒。\"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n    chatData.value = response\r\n  } catch (error) {\r\n    console.error('Failed to load messages:', error)\r\n  }\r\n}\r\n\r\n// 加载更多历史消息\r\nconst loadMoreMessages = async () => {\r\n  if (loading.value || !hasMore.value) return\r\n  \r\n  loading.value = true\r\n  try {\r\n    await new Promise(resolve => setTimeout(resolve, 1000))\r\n    const moreMessages = []\r\n    chatData.value.chat.unshift(...moreMessages)\r\n    page.value++\r\n  } catch (error) {\r\n    console.error('Failed to load more messages:', error)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  initMessages()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.chat-container {\r\n  height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background-color: #f5f5f5;\r\n}\r\n</style>\r\n","import Component from 'E:/Workspace/miniapp/chatBotMiniApp/pages/chatView.vue'\nwx.createComponent(Component)"],"names":["ref","uni","onMounted"],"mappings":";;;;;AAgBA,MAAM,cAAc,MAAW;AAC/B,MAAM,aAAa,MAAW;;;;AAE9B,UAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,UAAM,OAAOA,cAAG,IAAC,CAAC;AAClB,UAAM,UAAUA,cAAG,IAAC,IAAI;AAExB,UAAM,WAAWA,cAAAA,IAAI;AAAA,MACnB,UAAU;AAAA,MACV,SAAS;AAAA,MACT,YAAY;AAAA,MACZ,WAAW;AAAA,MACX,MAAM,CAAE;AAAA,IACV,CAAC;AAGD,UAAM,oBAAoB,CAAC,YAAY;AACrC,eAAS,MAAM,KAAK,KAAK;AAAA,QACvB,MAAM;AAAA,QACN,SAAS;AAAA,UACP,MAAM;AAAA,UACN;AAAA,QACD;AAAA,MACL,CAAG;AAAA,IACH;AAGA,UAAM,sBAAsB,CAAC,cAAc;AACzC,eAAS,MAAM,KAAK,KAAK;AAAA,QACvB,MAAM;AAAA,QACN,SAAS;AAAA,UACP,MAAM;AAAA,UACN,SAAS;AAAA,QACV;AAAA,MACL,CAAG;AAAA,IACH;AAGA,UAAM,eAAe,YAAY;AAC/B,UAAI;AAEF,cAAM,WAAW;AAAA,UACf,UAAU;AAAA,UACV,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,WAAW;AAAA,UACX,MAAM;AAAA,YACJ;AAAA,cACE,MAAM;AAAA,cACN,SAAS;AAAA,gBACP,MAAM;AAAA,gBACN,SAAS;AAAA,cACV;AAAA,YACF;AAAA,YACD;AAAA,cACE,MAAM;AAAA,cACN,SAAS;AAAA,gBACP,MAAM;AAAA,gBACN,SAAS;AAAA,cACV;AAAA,YACF;AAAA,YACD;AAAA,cACE,MAAM;AAAA,cACN,SAAS;AAAA,gBACP,MAAM;AAAA,gBACN,SAAS;AAAA,cACV;AAAA,YACF;AAAA,YACD;AAAA,cACE,MAAM;AAAA,cACN,SAAS;AAAA,gBACP,MAAM;AAAA,gBACN,SAAS;AAAA,cACV;AAAA,YACF;AAAA,YACD;AAAA,cACE,MAAM;AAAA,cACN,SAAS;AAAA,gBACP,MAAM;AAAA,gBACN,SAAS;AAAA,gBACT,QAAQ;AAAA,cACT;AAAA,YACF;AAAA,YACD;AAAA,cACE,MAAM;AAAA,cACN,SAAS;AAAA,gBACP,MAAM;AAAA,gBACN,SAAS;AAAA,cACV;AAAA,YACF;AAAA,UACF;AAAA,QACF;AACD,iBAAS,QAAQ;AAAA,MAClB,SAAQ,OAAO;AACdC,sBAAAA,MAAc,MAAA,SAAA,6BAAA,4BAA4B,KAAK;AAAA,MAChD;AAAA,IACH;AAGA,UAAM,mBAAmB,YAAY;AACnC,UAAI,QAAQ,SAAS,CAAC,QAAQ;AAAO;AAErC,cAAQ,QAAQ;AAChB,UAAI;AACF,cAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAI,CAAC;AACtD,cAAM,eAAe,CAAE;AACvB,iBAAS,MAAM,KAAK,QAAQ,GAAG,YAAY;AAC3C,aAAK;AAAA,MACN,SAAQ,OAAO;AACdA,sBAAAA,kDAAc,iCAAiC,KAAK;AAAA,MACxD,UAAY;AACR,gBAAQ,QAAQ;AAAA,MACjB;AAAA,IACH;AAEAC,kBAAAA,UAAU,MAAM;AACd,mBAAc;AAAA,IAChB,CAAC;;;;;;;;;;;;;;;ACpID,GAAG,gBAAgB,SAAS;"}