{"version":3,"file":"MessageList.js","sources":["components/MessageList.vue","../HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovY2hhdEJvdE1pbmlBcHAvY29tcG9uZW50cy9NZXNzYWdlTGlzdC52dWU"],"sourcesContent":["<template>\r\n  <scroll-view \r\n    class=\"message-list-container\"\r\n    scroll-y\r\n    :scroll-top=\"scrollTop\"\r\n    @scrolltoupper=\"handleScrollToUpper\"\r\n  >\r\n    <view v-if=\"loading\" class=\"loading-more\">\r\n      加载中...\r\n    </view>\r\n    \r\n    <view class=\"messages-list\">\r\n      <chat-message\r\n        v-for=\"(message, index) in chatData.chat\"\r\n        :key=\"index\"\r\n        :message=\"message\"\r\n        :user-avatar=\"chatData.userAvatar\"\r\n        :bot-avatar=\"chatData.botAvatar\"\r\n        :user-name=\"chatData.userName\"\r\n        :bot-name=\"chatData.botName\"\r\n      />\r\n    </view>\r\n  </scroll-view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, watch,nextTick } from 'vue'\r\nimport ChatMessage from './ChatMessage.vue'\r\n\r\nconst props = defineProps({\r\n  chatData: {\r\n    type: Object,\r\n    required: true\r\n  },\r\n  loading: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n\r\nconst emit = defineEmits(['load-more'])\r\n\r\nconst scrollTop = ref(0)\r\n\r\n// 监听消息列表变化，自动滚动到底部\r\nwatch(\r\n  () => props.chatData.chat.length,\r\n  () => {\r\n    console.log('消息列表长度变化，准备滚动到底部')\r\n    nextTick(() => {\r\n      console.log('执行滚动')\r\n      // 先设置一个很小的值，强制触发滚动更新\r\n      scrollTop.value = 0\r\n      nextTick(() => {\r\n        scrollTop.value = 99999\r\n      })\r\n    })\r\n  }\r\n)\r\n\r\n// 处理上拉加载更多\r\nconst handleScrollToUpper = () => {\r\n  emit('load-more')\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.message-list-container {\r\n  flex: 1;\r\n  height: calc(100vh - 60px - env(safe-area-inset-bottom));\r\n}\r\n\r\n.loading-more {\r\n  text-align: center;\r\n  padding: 10px 0;\r\n  color: #999;\r\n  font-size: 14px;\r\n}\r\n\r\n.messages-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16px;\r\n  padding: 20px;\r\n}\r\n</style> ","import Component from 'D:/chatBotMiniApp/components/MessageList.vue'\nwx.createComponent(Component)"],"names":["ref","watch","uni","nextTick"],"mappings":";;;;;AA2BA,MAAM,cAAc,MAAW;;;;;;;;;;;;;;;AAE/B,UAAM,QAAQ;AAWd,UAAM,OAAO;AAEb,UAAM,YAAYA,cAAG,IAAC,CAAC;AAGvBC,kBAAK;AAAA,MACH,MAAM,MAAM,SAAS,KAAK;AAAA,MAC1B,MAAM;AACJC,sBAAAA,MAAA,MAAA,OAAA,oCAAY,kBAAkB;AAC9BC,sBAAAA,WAAS,MAAM;AACbD,wBAAAA,MAAA,MAAA,OAAA,oCAAY,MAAM;AAElB,oBAAU,QAAQ;AAClBC,wBAAAA,WAAS,MAAM;AACb,sBAAU,QAAQ;AAAA,UAC1B,CAAO;AAAA,QACP,CAAK;AAAA,MACF;AAAA,IACH;AAGA,UAAM,sBAAsB,MAAM;AAChC,WAAK,WAAW;AAAA,IAClB;;;;;;;;;;;;;;;;;;;;;;;;;AC9DA,GAAG,gBAAgB,SAAS;"}